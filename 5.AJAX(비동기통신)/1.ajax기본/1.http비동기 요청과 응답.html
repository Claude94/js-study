<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <button id="load-btn">게시물 불러오기</button>
    <ul class="content"></ul>

    <script>
        document.getElementById('load-btn').addEventListener('click', e => {
            //HTTP 비동기 요청을 서버로 보내는 방법
            //1. XMLHttpRequest 객체를 생성
            const xhr = new XMLHttpRequest();

            //2. hrrp 요청 초기설정
            xhr.open('GET', 'http://127.0.0.1:5000/article');

            //3. http 요청 전송
            xhr.send();
            console.log(xhr);

            //4. 응답 정보체크
            xhr.onload = e => {
                if (xhr.status === 200) {
                    console.log(xhr.response);
                    makeResultData(xhr.response);
                } else {
                    console.error('통신연결 실패');
                }
            };
        });

        //응답 정보로 DOM을 조작하는 함수
        function makeResultData(articles) {

            // 서버가 응답한 테이터는 자바스크립트가 아니라 제아쓴포멧의 데이터입니다.
            // 따라서 자바스크립트 문법을 사용할 수 없습니다.
            // 제이쓴을 자바스크립트로 변환해서 사용해야합니다.

            //# json -> javascript : JSON.parse()
            //javascript -> json : JSON.stringify()

            //json을 js객체로 변환
            const articleList = JSON.parse(articles);
            // const firstArtcle = articlesList[0];
            // console.log('첫번째 개시물', firstArtcle);

            for (let board of articlesList) {
                const {id, writer, title} = board;
                const $li = document.createElement('li');
                $li.textContent = '# 글번호 : ${id}, 제목 : ${title}, 작성자: ${writer}';
                
                $ul.appendChild($li);
            }
        }
    </script>

</body>

</html>